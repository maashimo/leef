<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Guava (1 kg) - üçÉ Leef</title>
<link rel="stylesheet" href="products-guava.css">
<style>
.section { border-bottom: 1px solid #ddd; padding-bottom: 16px; margin-bottom: 16px; }
.section h2 { font-size: 1.5rem; margin-bottom: 8px; color: #065f46; }
.rating { color: #facc15; }
.btn-primary { background-color: #065f46; color: white; padding: 10px; border-radius: 6px; cursor: pointer; }
.btn-secondary { background-color: #10b981; color: white; padding: 10px; border-radius: 6px; cursor: pointer; }
.certificate-link { color: #2563eb; text-decoration: underline; display: block; margin-bottom: 4px; }
.feedback { background: #f3f4f6; padding: 8px; border-radius: 6px; margin-bottom: 8px; }
.hidden { display: none; }
.flex-gap { display: flex; gap: 8px; margin-bottom: 8px; }
.input-location, .input-quantity { padding: 6px; border-radius: 4px; border: 1px solid #ccc; flex: 1; }

/* Quantity stepper styles */
.quantity-container {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 16px;
  max-width: 200px;
}
.quantity-btn {
  background-color: #f3f4f6;
  border: 1px solid #d1d5db;
  color: #374151;
  width: 32px;
  height: 32px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  font-weight: bold;
}
.quantity-btn:hover {
  background-color: #e5e7eb;
}
.quantity-input {
  width: 60px;
  height: 32px;
  text-align: center;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 16px;
}
.add-to-cart-btn {
  background-color: #ef4444;
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
  margin-top: 8px;
}
.add-to-cart-btn:hover {
  background-color: #dc2626;
}
.error-msg {
  color: #ef4444;
  font-size: 12px;
  margin-top: 4px;
  display: none;
}

/* üîô Back button styling */
.back-btn {
  display: inline-block;
  background-color: #065f46;
  color: white;
  padding: 8px 14px;
  border-radius: 6px;
  text-decoration: none;
  font-weight: bold;
  margin-bottom: 20px;
  transition: background-color 0.2s ease;
}
.back-btn:hover {
  background-color: #047857;
}
</style>
</head>
<body class="bg-stone-50">
<div class="flex min-h-screen">
  <main class="flex-1 p-8">
    
    <!-- üîô Back Button -->
    <a href="products.html" class="back-btn">‚Üê Back </a>

    <div class="product-detail flex flex-col md:flex-row gap-8">
      
      <!-- Product Image -->
      <div class="product-detail-image md:w-1/3">
        <img src="images/cabbage.png" alt="Guava" class="rounded-lg">
      </div>

      <!-- Product Info -->
      <div class="product-detail-info md:w-2/3">

        <!-- 1Ô∏è‚É£ Product Overview -->
        <div class="section">
          
          <h1 class="text-3xl font-bold mb-2">cabbage (1 kg)</h1>
          <p class="text-stone-700 mb-2">Locally grown, hand-picked, and delivered fresh daily.</p>
          <p class="text-2xl font-bold text-green-700">LKR 350 / kg</p>
          <p class="text-stone-700 rating mb-1">Product Rating: ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</p>
        </div>

        <!-- (rest of your sections remain unchanged) -->


        <!-- 2Ô∏è‚É£ Delivery & Purchase -->
        <div class="section">
          <h2>Delivery & Purchase Options</h2>

          <label class="font-bold text-stone-700 mb-1">Delivery Type:</label>
          <select id="locationType" class="mb-4 p-2 border rounded w-full">
            <option value="one">One Location</option>
            <option value="multiple">Multiple Locations</option>
          </select>

          <!-- Single Location Section -->
          <div id="single-location" class="mb-4">
            <label class="font-bold">Use profile address or another location?</label>
            <select id="singleChoice" class="mb-2 p-2 border rounded w-full">
              <option value="profile">Profile Address</option>
              <option value="other">Another Location</option>
            </select>

            <!-- Profile Address -->
            <div id="profile-address-section" class="mb-2">
              <label class="font-bold mb-1">Select Quantity (kg):</label>
              <div class="quantity-container">
                <button type="button" class="quantity-btn" onclick="updateQuantity('profile', -1)">‚àí</button>
                <input type="number" id="quantityProfile" value="1" min="1" max="20" class="quantity-input">
                <button type="button" class="quantity-btn" onclick="updateQuantity('profile', 1)">+</button>
              </div>
              <div id="profile-error" class="error-msg">Value must be less than or equal to 20.</div>
            </div>

            <!-- Other Location -->
            <div id="other-location-section" class="mb-2 hidden">
              <input type="text" id="other-location-input" placeholder="Enter location"
                class="mb-2 p-2 border rounded w-full">
              <label class="font-bold mb-1">Select Quantity (kg):</label>
              <div class="quantity-container">
                <button type="button" class="quantity-btn" onclick="updateQuantity('other', -1)">‚àí</button>
                <input type="number" id="quantityOther" value="1" min="1" max="20" class="quantity-input">
                <button type="button" class="quantity-btn" onclick="updateQuantity('other', 1)">+</button>
              </div>
              <div id="other-error" class="error-msg">Value must be less than or equal to 20.</div>
            </div>

            <div class="flex gap-4">
              <button id="buyNowSingle" class="btn-secondary w-full">Buy Now</button>
            </div>
          </div>

          <!-- Multiple Locations -->
          <div id="multiple-locations" class="hidden">
            <div id="locations-container">
              <div class="flex-gap">
                <input type="text" placeholder="Enter location" class="input-location">
                <div class="quantity-container" style="flex: none;">
                  <button type="button" class="quantity-btn" onclick="updateMultiQuantity(this, -1)">‚àí</button>
                  <input type="number" value="1" min="1" max="20" class="quantity-input" style="width: 50px;">
                  <button type="button" class="quantity-btn" onclick="updateMultiQuantity(this, 1)">+</button>
                </div>
                <button type="button" onclick="addLocationField()" class="btn-primary">+</button>
              </div>
            </div>
            <button type="button" onclick="sendRequest()" class="btn-secondary mt-2">Send Request for Approval</button>
          </div>
        </div>

        <!-- 3Ô∏è‚É£ Feedback -->
        <div class="section">
          <h2>Customer Feedback</h2>
          <div class="feedback">
            <p><strong>Customer:</strong> Super fresh and juicy!</p>
            <p><strong>Admin:</strong> Thank you for your feedback!</p>
          </div>
        </div>

        <!-- 4Ô∏è‚É£ Q&A -->
        <div class="section" id="qnaSection">
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <h2>Q&A</h2>
            <button id="askQuestionBtn" class="btn-primary" onclick="openQuestionForm()">Ask Question</button>
          </div>

          <div id="qnaList" style="margin-top:10px;">
            <div class="feedback">
              <p><strong>Customer:</strong> Do you deliver to Kandy?</p>
              <p><strong>Admin:</strong> Yes, delivery acdtrong>Customer:</strong> Are these organic?</p>
              <p><strong>Admin:</strong> Yes, 100% organically grown.</p>
            </div>
          </div>

          <div id="questionForm" class="hidden" style="margin-top:10px;">
            <textarea id="questionInput" rows="3" placeholder="Write your question..." style="width:100%;padding:8px;border-radius:6px;border:1px solid #d1d5db;"></textarea>
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
              <button onclick="closeQuestionForm()" class="btn-secondary" style="background:#9ca3af">Cancel</button>
              <button onclick="submitQuestion()" class="btn-primary">Submit Question</button>
            </div>
          </div>
        </div>

        <!-- 5Ô∏è‚É£ Seller Info -->
        <div class="section">
          <h2>Seller Information</h2>
          <p class="mb-1">Shop: Leef üçÉ</p>
          <p class="mb-1 rating">Shop Rating: ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</p>
          <p class="mb-2">Seller: Thilina Perera</p>
          <p class="font-bold mb-1">Certificates:</p>
          <a href="certificates/certificate1.pdf" target="_blank" class="certificate-link">Certificate 1</a>
          <a href="certificates/certificate2.pdf" target="_blank" class="certificate-link">Certificate 2</a>
        </div>

      </div>
    </div>
  </main>
</div>

<script>
const locationType = document.getElementById('locationType');
const singleLocation = document.getElementById('single-location');
const multipleLocations = document.getElementById('multiple-locations');
const singleChoice = document.getElementById('singleChoice');
const profileSection = document.getElementById('profile-address-section');
const otherSection = document.getElementById('other-location-section');

locationType.addEventListener('change', () => {
  if(locationType.value === 'one') {
    singleLocation.classList.remove('hidden');
    multipleLocations.classList.add('hidden');
  } else {
    singleLocation.classList.add('hidden');
    multipleLocations.classList.remove('hidden');
  }
});

singleChoice.addEventListener('change', () => {
  if(singleChoice.value === 'profile') {
    profileSection.classList.remove('hidden');
    otherSection.classList.add('hidden');
  } else {
    profileSection.classList.add('hidden');
    otherSection.classList.remove('hidden');
  }
});

const locationsContainer = document.getElementById('locations-container');
function addLocationField() {
  const div = document.createElement('div');
  div.classList.add('flex-gap');
  div.innerHTML = `
    <input type="text" placeholder="Enter location" class="input-location">
    <div class="quantity-container" style="flex: none;">
      <button type="button" class="quantity-btn" onclick="updateMultiQuantity(this, -1)">‚àí</button>
      <input type="number" value="1" min="1" max="20" class="quantity-input" style="width: 50px;">
      <button type="button" class="quantity-btn" onclick="updateMultiQuantity(this, 1)">+</button>
    </div>
    <button type="button" onclick="this.parentNode.remove()" class="btn-secondary">-</button>
  `;
  locationsContainer.appendChild(div);
}

function updateQuantity(type, change) {
  const input = document.getElementById(`quantity${type.charAt(0).toUpperCase() + type.slice(1)}`);
  const error = document.getElementById(`${type}-error`);
  let value = parseInt(input.value) || 1;
  value = Math.max(1, Math.min(20, value + change));
  input.value = value;
  error.style.display = 'none';
}

function updateMultiQuantity(btn, change) {
  const container = btn.closest('.quantity-container');
  const input = container.querySelector('.quantity-input');
  let value = parseInt(input.value) || 1;
  value = Math.max(1, Math.min(20, value + change));
  input.value = value;
}

document.getElementById('buyNowSingle').addEventListener('click', handleSingle);

function handleSingle() {
   let location = '';
   let qty = 1;

   if(singleChoice.value === 'profile') {
     location = 'Profile Address';
     qty = parseInt(document.getElementById('quantityProfile').value);
   } else {
     location = document.getElementById('other-location-input').value.trim();
     qty = parseInt(document.getElementById('quantityOther').value);
     if(!location) return alert('Please enter a location.');
   }

   if (qty > 20) {
     const error = singleChoice.value === 'profile' ? document.getElementById('profile-error') : document.getElementById('other-error');
     error.style.display = 'block';
     return;
   }

   const cartItem = { name: 'Guava (1 kg)', price: 350, img: 'images/freshvege.png', qty, location };

   // Always go to checkout with this single-item purchase
   localStorage.setItem('cart', JSON.stringify([cartItem]));
   window.location.href = 'checkout.html';
}

function sendRequest() {
  const divs = locationsContainer.querySelectorAll('.flex-gap');
  for (let div of divs) {
    const location = div.querySelector('.input-location').value.trim();
    if(!location) return alert('Please enter all locations.');
    const qty = parseInt(div.querySelector('.quantity-input').value);
    if (qty > 20) return alert('Quantity must be less than or equal to 20 for all locations.');
  }
  alert('Request sent to admin for approval of multiple locations.');
}

// Q&A Section Script
function openQuestionForm() {
  document.getElementById('questionForm').classList.remove('hidden');
}

function closeQuestionForm() {
  document.getElementById('questionForm').classList.add('hidden');
}

function submitQuestion() {
  const question = document.getElementById('questionInput').value.trim();
  if(!question) return alert('Please enter your question.');

  // Here you would typically handle the question submission to the server
  // For this example, we'll just add it to the Q&A list

  const div = document.createElement('div');
  div.classList.add('feedback');
  div.innerHTML = `<p><strong>Customer:</strong> ${question}</p><p><strong>Admin:</strong> Your question has been received and will be answered shortly.</p>`;
  document.getElementById('qnaList').appendChild(div);

  document.getElementById('questionInput').value = '';
  closeQuestionForm();
}
</script>
</body>
</html>