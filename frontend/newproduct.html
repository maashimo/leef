<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add New Product - leef üçÉ</title>
  <link rel="stylesheet" href="dashboard.css">
  <style>
    /* Top Navbar Styles (Standardized) */
    .top-navbar {
      background-color: rgba(10, 10, 10, 0.95);
      border-bottom: 1px solid #333;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .navbar-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .navbar-logo {
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: bold;
      color: #4ade80;
    }

    .navbar-nav {
      display: flex;
      list-style: none;
      margin: 0;
      padding: 0;
      gap: 2rem;
    }

    .navbar-link {
      text-decoration: none;
      color: #eee;
      font-weight: 500;
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      transition: background-color 0.2s;
    }

    .navbar-link.active {
      background-color: #10b981;
      color: white;
    }

    .navbar-link:hover {
      background-color: #333;
    }

    @media (max-width: 768px) {
      .top-navbar {
        flex-direction: column;
        align-items: flex-start;
      }

      .navbar-nav {
        gap: 1rem;
        flex-wrap: wrap;
        justify-content: center;
      }
    }

    /* Form Specifics */
    .form-card {
      background: #1a1a1a;
      border: 1px solid #333;
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr 300px;
      gap: 2rem;
    }

    @media(max-width: 900px) {
      .form-grid {
        grid-template-columns: 1fr;
      }
    }

    .form-group {
      margin-bottom: 1.2rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #ccc;
      font-size: 0.95rem;
    }

    .form-input {
      width: 100%;
      padding: 0.75rem;
      background: #111;
      border: 1px solid #333;
      border-radius: 8px;
      color: #fff;
      outline: none;
      font-size: 1rem;
    }

    .form-input:focus {
      border-color: #4ade80;
    }

    .helper-text {
      color: #888;
      font-size: 0.85rem;
      margin-top: 0.25rem;
    }

    .note-card {
      background: #111;
      border: 1px solid #333;
      border-radius: 10px;
      padding: 1.5rem;
    }
  </style>
</head>

<body class="">

  <!-- Navbar -->
  <nav class="top-navbar">
    <div class="navbar-header">
      <a href="index.html" class="navbar-logo">
        leef üçÉ
      </a>
    </div>
    <ul class="navbar-nav">
      <li><a href="seller-dashboard.html" class="navbar-link">Dashboard</a></li>
      <li><a href="inventory.html" class="navbar-link active">Inventory</a></li>
      <li><a href="profile-seller.html" class="navbar-link">Profile</a></li>
      <li><a href="login.html" class="navbar-link" style="color:#ef4444;">Logout</a></li>
    </ul>
  </nav>

  <main class="main-content container" style="max-width: 1000px; margin: 2rem auto; padding: 0 1rem;">
    <div style="margin-bottom: 2rem;">
      <a href="inventory.html"
        style="color: #9ca3af; text-decoration: none; display: inline-flex; align-items: center; gap: 0.4rem; font-size: 0.9rem; margin-bottom: 0.5rem;">
        ‚Üê Back to Inventory
      </a>
      <h1 class="page-title">Add New Product</h1>
      <p class="page-subtitle">Fill required fields and add product details.</p>
    </div>

    <div class="form-card">
      <form id="sellerAddProductForm" class="form-grid">

        <!-- Left Column: Main Fields -->
        <div>
          <div class="form-group">
            <label class="form-label">Product Name</label>
            <input type="text" name="name" class="form-input" placeholder="e.g. Organic Carrots" required>
          </div>

          <div class="form-group">
            <label class="form-label">Category</label>
            <select name="category" class="form-input" required>
              <option value="" disabled selected>Select Category</option>
              <option value="Vegetable">Vegetable</option>
              <option value="Fruit">Fruit</option>
              <option value="Seasonal">Seasonal</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label">Price (LKR)</label>
            <div style="position: relative;">
              <span
                style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: #666;">Rs</span>
              <input type="text" name="price" class="form-input" style="padding-left: 2.5rem;" placeholder="e.g. 150/kg"
                required>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Stock Quantity</label>
            <input type="text" name="stock" class="form-input" placeholder="e.g. 50kg or 10 boxes" required>
          </div>

          <div class="form-group">
            <label class="form-label">Product Image (Optional)</label>
            <div style="position:relative;">
              <input type="file" name="image" class="form-input" accept="image/*" style="padding:0.5rem;">
              <p class="helper-text">You can upload an image now, or Admin will add it later.</p>
            </div>
          </div>

          <div style="display: flex; gap: 1rem; margin-top: 2rem;">
            <a href="inventory.html" class="btn"
              style="background: #333; color: #fff; text-decoration: none;">Cancel</a>
            <button type="submit" class="btn btn-primary">Add Product</button>
          </div>
        </div>

        <!-- Right Column: Note / Extras -->
        <aside>
          <div class="note-card">
            <label class="form-label" style="font-size: 0.9rem; color: #9ca3af;">Note</label>
            <textarea class="form-input" name="note" rows="5"
              placeholder="Add any internal notes about harvest date, quality checks, etc..."></textarea>
            <p class="helper-text">These notes are visible in your inventory list.</p>
          </div>
        </aside>

      </form>
    </div>
  </main>

  <script>
    document.getElementById('sellerAddProductForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const user = JSON.parse(localStorage.getItem('user'));
      if (!user || user.role !== 'seller') {
        alert('You must be logged in as a seller to add products.');
        window.location.href = 'login.html';
        return;
      }

      const formData = new FormData(this);
      formData.append('seller_id', user.id);

      try {
        const response = await fetch('http://localhost:5000/api/products/add', {
          method: 'POST',
          // Header content-type for multipart is automatic
          body: formData
        });

        const result = await response.json();

        if (response.ok) {
          alert('Product added successfully!');
          window.location.href = 'inventory.html';
        } else {
          alert('Error: ' + result.message);
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Failed to connect to server.');
      }
    });
  </script>

</body>

</html>